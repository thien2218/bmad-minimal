template:
  id: epic-template-v2
  name: Epic Document
  version: 2.0
  output:
    format: markdown
    filename: docs/epics/{{epic_number}}.{{epic_title_short}}.md
    title: "Epic {{epic_number}}: {{epic_title}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

agent_config:
  editable_sections:
    - Epic Overview
    - Story List
    - Change Log

sections:
  - id: epic-overview
    title: Epic Overview
    instruction: |
      Define the epic's purpose, scope, and completion criteria. This provides the foundation for story generation and ensures alignment with PRD goals.
    sections:
      - id: epic-goal
        title: Epic Goal
        type: paragraph
        instruction: |
          Write a clear goal statement (2-3 sentences) explaining:
          - What this epic accomplishes
          - Why it's valuable to users/business
          - How it supports PRD goals
        template: "This epic delivers {{epic_objective}} by implementing {{solution_approach}}, enabling {{user_value}} and advancing the product goal of {{product_alignment}}."
        elicit: true

      - id: epic-description
        title: Epic Description
        type: paragraphs
        instruction: |
          Provide detailed context (2-3 paragraphs):
          - Current state and problem being solved
          - Solution approach and key capabilities delivered
          - User scenarios enabled by this epic
          - Expected outcomes and success criteria
        elicit: true

      - id: epic-acceptance-criteria
        title: Epic Acceptance Criteria
        type: numbered-list
        instruction: |
          Define measurable criteria for epic completion:
          - End-to-end functionality requirements
          - Quality and performance thresholds
          - Integration completion requirements
          - Reference specific PRD requirements being fulfilled
        template: "{{criterion_number}}: {{acceptance_criterion}}"
        elicit: true

  - id: scope-boundaries
    title: Scope and Boundaries
    instruction: |
      Clearly define epic boundaries to guide story creation and prevent scope creep.
    elicit: true
    sections:
      - id: in-scope
        title: In Scope
        type: bullet-list
        instruction: |
          Specify what IS included in this epic:
          - Features and functionality being delivered
          - Technical components being built/modified
          - UI/UX elements if applicable
          - Infrastructure or deployment changes
          - Reference specific PRD requirements (FR/NFR numbers)
        template: "- {{scope_item}} ({{prd_reference}})"

      - id: out-of-scope
        title: Out of Scope
        type: bullet-list
        instruction: |
          Explicitly exclude items to prevent confusion:
          - Related features deferred to future epics
          - Technical debt not being addressed
          - Cross-cutting concerns handled elsewhere
        template: "- {{excluded_item}} - {{deferral_reason}}"

  - id: requirements-mapping
    title: Requirements Mapping
    instruction: |
      Map this epic to specific PRD requirements for traceability and story context.
    sections:
      - id: functional-requirements
        title: Functional Requirements Addressed
        type: bullet-list
        instruction: |
          List PRD functional requirements this epic implements:
          - Reference exact FR numbers from PRD
          - Note full vs partial implementation
          - Provide brief context for story generation
        template: "- **{{fr_id}}:** {{requirement_summary}} - {{implementation_scope}}"
        elicit: true

      - id: non-functional-requirements
        title: Non-Functional Requirements
        type: bullet-list
        instruction: |
          List applicable PRD non-functional requirements:
          - Reference exact NFR numbers from PRD
          - Include performance, security, quality requirements
          - Note acceptance thresholds for testing
        template: "- **{{nfr_id}}:** {{requirement_summary}} - {{acceptance_threshold}}"
        elicit: true

  - id: technical-context
    title: Technical Context
    instruction: |
      Provide technical guidance from architecture document for story implementation.
    sections:
      - id: architecture-alignment
        title: Architecture Alignment
        type: bullet-list
        instruction: |
          Reference relevant architecture decisions:
          - Components being implemented/modified
          - Architectural patterns to follow
          - Technology stack elements in use
          - Security and error handling patterns
        template: "- **{{architecture_element}}:** {{epic_application}}"
        elicit: true

      - id: integration-requirements
        title: Integration Requirements
        type: bullet-list
        instruction: |
          Document integration points for this epic:
          - Internal component interactions
          - External API integrations
          - Database schema changes
          - Message/event handling
        template: "- **{{integration_type}}:** {{integration_details}}"
        elicit: true

      - id: testing-context
        title: Testing Context
        type: bullet-list
        instruction: |
          Define testing requirements from architecture:
          - Unit testing standards and coverage
          - Integration testing needs
          - End-to-end testing scope
          - Performance/security testing requirements
        template: "- **{{test_type}}:** {{test_requirements}}"
        elicit: true

  - id: story-breakdown
    title: Story Breakdown
    instruction: |
      Define the complete list of stories for this epic with proper sequencing for story generation.
    sections:
      - id: story-list
        title: Story List
        type: numbered-list
        instruction: |
          List all stories in logical sequence:
          - Each story delivers complete vertical functionality
          - Stories build upon previous stories
          - Include story title and brief goal
          - Note any direct dependencies
          - Size appropriately for AI agent execution (2-4 hours of work)
        template: "{{story_number}}: **{{story_title}}** - {{story_goal}} {{dependency_note}}"
        elicit: true

      - id: story-sequencing-rationale
        title: Story Sequencing Rationale
        type: paragraph
        instruction: |
          Explain the logical flow of stories:
          - Why stories are ordered as presented
          - Which stories enable subsequent stories
          - Any parallel development opportunities
          - Critical path considerations
        elicit: true

  - id: dependencies
    title: Dependencies
    instruction: |
      Document dependencies that impact story creation and sequencing.
    elicit: true
    sections:
      - id: epic-dependencies
        title: Epic Dependencies
        type: bullet-list
        instruction: |
          List dependencies on other epics or external deliverables:
          - Prerequisites that must complete before this epic
          - Shared components from other epics
          - External team dependencies
        template: "- **{{dependency_type}}:** {{dependency_description}} - {{impact_on_epic}}"

      - id: story-dependencies
        title: Story Dependencies
        type: bullet-list
        instruction: |
          Document intra-epic story dependencies:
          - Which stories depend on others within this epic
          - Shared technical foundations between stories
          - Database or infrastructure prerequisites
        template: "- **Story {{story_id}}** depends on **Story {{prerequisite_story_id}}:** {{dependency_reason}}"

  - id: change-log
    title: Change Log
    type: table
    columns: [Date, Version, Description, Author]
    instruction: Track document versions and changes
    owner: product-development-master
    editors: [product-development-master]

  - id: next-steps
    title: Next Steps
    instruction: |
      Generate prompts for story creation and development handoff.
    sections:
      - id: story-creation-prompt
        title: Story Creation Prompt
        instruction: |
          Create a prompt template for generating individual stories from this epic:
          - Reference this epic document and prerequisites
          - Include story-specific context
          - Provide technical guidance for story completion
        template: |
          Create Story {{epic_number}}.{{story_number}} using the story template with this context:

          **Epic:** {{epic_title}} (Epic {{epic_number}})
          **Story:** {{story_title}}
          **Epic Goal:** {{epic_goal_summary}}
          **Technical Context:** Reference architecture document sections: {{relevant_architecture_sections}}
          **Requirements:** This story addresses {{story_requirements_mapping}}
          **Dependencies:** {{story_dependencies}}

          Use the epic document ({{epic_document_path}}) and architecture document (docs/architecture.md) for complete context.

      - id: development-handoff
        title: Development Handoff
        instruction: |
          Provide essential information for development team epic kickoff:
          - Architecture document sections to review
          - First story to implement
          - Key technical decisions from epic context
        template: |
          **Architecture Focus:** Review {{architecture_sections_to_study}}
          **Starting Story:** {{first_story_id}} - {{first_story_title}}
          **Technical Priorities:** {{key_technical_considerations}}
          **Testing Standards:** {{testing_approach_summary}}