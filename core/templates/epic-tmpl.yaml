template:
  id: epic-template-v2
  name: Epic Document
  version: 2.0
  output:
    format: markdown
    filename: docs/epics/{{epic_number}}.{{epic_title_short}}.md
    title: "Epic {{epic_number}}: {{epic_title}}"

workflow:
  mode: interactive
  elicitation: advanced-elicitation

sections:
  - id: status
    title: Status
    type: choice
    choices: [Review, InProgress, Approved]
    instruction: Select the current status of the story
    owner: product-development-master
    editors: [product-development-master]

  - id: epic-overview
    title: Epic Overview
    instruction: |
      Define the epic's purpose, scope, and completion criteria. This provides the foundation for story generation and ensures alignment with PRD goals.
    owner: product-development-master
    editors: [product-development-master]
    sections:
      - id: epic-goal
        title: Epic Goal
        type: paragraph
        instruction: |
          Write a clear goal statement (2-3 sentences) explaining:
          - What this epic accomplishes
          - Why it's valuable to users/business
          - How it supports PRD goals
        template: "This epic delivers {{epic_objective}} by implementing {{solution_approach}}, enabling {{user_value}} and advancing the product goal of {{product_alignment}}."
        elicit: true

      - id: epic-description
        title: Epic Description
        type: paragraphs
        instruction: |
          Provide detailed context (2-3 paragraphs):
          - Current state and problem being solved
          - Solution approach and key capabilities delivered
          - User scenarios enabled by this epic
          - Expected outcomes and success criteria
        elicit: true

      - id: epic-acceptance-criteria
        title: Epic Acceptance Criteria
        type: numbered-list
        instruction: |
          Define measurable criteria for epic completion:
          - End-to-end functionality requirements
          - Quality and performance thresholds
          - Integration completion requirements
          - Reference specific PRD requirements being fulfilled
        template: "{{criterion_number}}: {{acceptance_criterion}}"
        elicit: true

  - id: scope-boundaries
    title: Scope and Boundaries
    instruction: |
      Clearly define epic boundaries to guide story creation and prevent scope creep.
    elicit: true
    owner: product-development-master
    editors: [product-development-master]
    sections:
      - id: in-scope
        title: In Scope
        type: bullet-list
        instruction: |
          Specify what IS included in this epic:
          - Features and functionality being delivered
          - Technical components being built/modified
          - UI/UX elements if applicable
          - Infrastructure or deployment changes
          - Reference specific PRD requirements (FR/NFR numbers)
        template: "- {{scope_item}} ({{prd_reference}})"

      - id: out-of-scope
        title: Out of Scope
        type: bullet-list
        instruction: |
          Explicitly exclude items to prevent confusion:
          - Related features deferred to future epics
          - Technical debt not being addressed
          - Cross-cutting concerns handled elsewhere
        template: "- {{excluded_item}} - {{deferral_reason}}"

  - id: requirements-mapping
    title: Requirements Mapping
    instruction: |
      Map this epic to specific PRD requirements for traceability and story context.
    owner: product-development-master
    editors: [product-development-master]
    sections:
      - id: functional-requirements
        title: Functional Requirements Addressed
        type: bullet-list
        instruction: |
          List PRD functional requirements this epic implements:
          - Reference exact FR numbers from PRD
          - Note full vs partial implementation
          - Provide brief context for story generation
        template: "- **{{fr_id}}:** {{requirement_summary}} - {{implementation_scope}}"
        elicit: true

      - id: non-functional-requirements
        title: Non-Functional Requirements
        type: bullet-list
        instruction: |
          List applicable PRD non-functional requirements:
          - Reference exact NFR numbers from PRD
          - Include performance, security, quality requirements
          - Note acceptance thresholds for testing
        template: "- **{{nfr_id}}:** {{requirement_summary}} - {{acceptance_threshold}}"
        elicit: true

  - id: story-breakdown
    title: Story Breakdown
    instruction: |
      Define the complete list of stories for this epic with proper sequencing for story generation.
      Include a priority for each story (integer 1–5, where 1 = highest priority).
      Order stories primarily by dependencies (no story should depend on a later story),
      then by priority (1 first) to deliver highest-value work earlier when safe.
    owner: product-development-master
    editors: [product-development-master]
    sections:
      - id: story-list
        title: Story List
        type: numbered-list
        instruction: |
          List all stories in logical sequence:
          - Each story delivers complete vertical functionality
          - Stories build upon previous stories
          - Include story title and brief goal
          - Note any direct dependencies
          - Include Priority (1–5, 1 = highest)
          - Size appropriately for AI agent execution (2-4 hours of work)
        template: "{{story_number}}: **{{story_title}}** - {{story_goal}} {{dependency_note}} [Priority: {{priority}}]"
        elicit: true

      - id: story-sequencing-rationale
        title: Story Sequencing Rationale
        type: paragraph
        instruction: |
          Explain the logical flow of stories:
          - Why stories are ordered as presented
          - Which stories enable subsequent stories
          - Any parallel development opportunities
          - Critical path considerations
        elicit: true

  - id: dependencies
    title: Dependencies
    instruction: |
      Document dependencies that impact story creation and sequencing.
    elicit: true
    owner: product-development-master
    editors: [product-development-master]
    sections:
      - id: epic-dependencies
        title: Epic Dependencies
        type: bullet-list
        instruction: |
          List dependencies on other epics or external deliverables:
          - Prerequisites that must complete before this epic
          - Shared components from other epics
          - External team dependencies
        template: "- **{{dependency_type}}:** {{dependency_description}} - {{impact_on_epic}}"

      - id: story-dependencies
        title: Story Dependencies
        type: bullet-list
        instruction: |
          Document intra-epic story dependencies:
          - Which stories depend on others within this epic
          - Shared technical foundations between stories
          - Database or infrastructure prerequisites
        template: "- **Story {{story_id}}** depends on **Story {{prerequisite_story_id}}:** {{dependency_reason}}"
